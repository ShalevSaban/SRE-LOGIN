# SRE Home Test â€“ Mini System

This project demonstrates a full-stack system with **authentication, database integration, CDC streaming, and Kafka consumer**, all orchestrated with Docker Compose.

## âœ… Mission Requirements Met
- **Frontend (HTML + Nginx):** Simple login page (email/password).
- **Backend (Node.js + Express):**
  - REST API with `/login`.
  - JWT authentication; tokens stored in DB.
  - JSON logging via **log4js**.
- **Database (TiDB):**
  - Schema + default user auto-loaded with `db/init.sql` and `db/init-db.sh`.
- **Message Queue (Kafka):**
  - Included in Docker Compose.
  - **TiCDC â†’ Kafka** changefeed streams DB changes.
- **Consumer (Node.js + KafkaJS):**
  - Subscribes to Kafka topic.
  - Logs DB change events in JSON.

## ğŸ“‚ Project Structure
.
â”œâ”€â”€ docker-compose.yml             # Orchestration for all services
â”‚
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ init.sql                   # Schema + default user
â”‚   â””â”€â”€ init-db.sh                 # Applies schema on startup
â”‚
â”œâ”€â”€ server/                        # Backend API service
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ app.js                     # Express app with routes
â”‚   â”œâ”€â”€ auth.js                    # JWT handling
â”‚   â””â”€â”€ db.js                      # TiDB connection
â”‚
â”œâ”€â”€ consumer/                      # Kafka consumer service
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ index.js                   # Subscribes to Kafka + logs events
â”‚
â””â”€â”€ client/                        # Frontend
    â”œâ”€â”€ Dockerfile
    â”œâ”€â”€ index.html                 # Simple login page
    â””â”€â”€ nginx.conf                 # Nginx config

## â–¶ï¸ Run the System
From the project root:

docker-compose up --build

This command **builds and starts everything**:
- TiDB (with PD/TiKV)
- TiCDC (streams DB changes)
- Kafka (broker)
- API (server)
- Consumer
- Client (Nginx + login page)

By default, logs for all services will appear in your terminal.

## ğŸŒ Access
- **Client (login page):** http://localhost:8080
- **API (Node.js):** http://localhost:3000
  - `/login`, `/profile`
- **TiDB SQL:** available at `localhost:4000`

âœ… With a single command, the system comes up ready with **DB + CDC + Kafka + API + Consumer + Client**.
